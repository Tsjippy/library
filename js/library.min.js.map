{"version":3,"file":"library.min.js","mappings":"mBAEAA,QAAQC,IAAI,qBAoFZC,SAASC,iBAAiB,mBAAoB,WAG9C,GAEAD,SAASC,iBAAiB,QAASC,IAClC,IAAIC,EAASD,EAAMC,OAEhBA,EAAOC,QAAQ,aAlCnBC,eAAuBF,GACtB,IAAIG,EAASH,EAAOI,QAAQ,MACxBC,EAASL,EAAOI,QAAQ,MACxBE,EAAY,IAAIC,SAEpBF,EAAIG,iBAAiB,mBAAmBC,QAAQC,GAAOJ,EAASK,OAAOD,EAAME,KAAMF,EAAMG,QACzFR,EAAIG,iBAAiB,YAAYC,QAAQK,GAAKR,EAASK,OAAO,QAASG,EAAIC,MAC3EpB,QAAQC,IAAII,GAEZA,EAAOgB,UAAUC,IAAI,UACrBd,EAAKe,cAAc,sBAAsBF,UAAUG,OAAO,UAE1D,IAAIC,QAAiBC,WAAWC,aAAa,mBAAoBhB,GAE9Dc,GACFzB,QAAQC,IAAIwB,GAEZjB,EAAKoB,UAAYH,EAEjBI,KAAKC,eAAeL,EAASM,WAE7B1B,EAAOgB,UAAUG,OAAO,UACxBhB,EAAKe,cAAc,sBAAsBF,UAAUC,IAAI,UAEzD,CAWEU,CAAQ3B,GACAA,EAAOC,QAAQ,iBACvBD,EAAOmB,SAILnB,EAAOgB,UAAUY,SAAS,YAC5B/B,SAASgC,eAAe,OAAO7B,EAAO8B,QAAQC,KAAK,SAASf,UAAUG,OAAO,UAG3EnB,EAAOC,QAAQ,+BAtEnBC,eAA0BF,GACzB,IACIoB,QAAiBC,WAAWW,WAAWhC,EAAQ,iCAEnD,GAAGoB,EAAS,CAEOpB,EAAOI,QAAQ,QAAQc,cAAc,uBAAuBL,MAA9E,IACIoB,EAAWjC,EAAOI,QAAQ,QAAQc,cAAc,sBAAsBL,MACtEqB,EAAWlC,EAAOI,QAAQ,QAAQc,cAAc,qBAAqBL,MAIrEsB,EAAO,8EAEsBF,cAAqBA,mBAA0Bb,EAASgB,mEAC1CF,oCAd5CG,GAiBOC,mBAAmB,aAAcH,GAC3CX,KAAKe,aAELf,KAAKC,eAAe,yBAAyBS,aAC9C,CACD,CAgDEM,CAAWxC,I","sources":["webpack://library/./library.js"],"sourcesContent":["import { addStyles } from '../../../plugins/sim-plugin/includes/js/imports.js';\r\n\r\nconsole.log(\"library.js loaded\");\r\n\r\n\r\nfunction catChanged(target){\r\n\tvar parentId = target.closest('.infobox').dataset.parent;\r\n\t\r\n\tvar parentDiv = target.closest('.categories');\r\n\t\r\n\tif(target.checked){\r\n\t\t//An recipetype is just selected, find all element with its value as parent attribute\r\n\t\tparentDiv.querySelectorAll(\"[data-parent='\"+target.value+\"']\").forEach(el=>{\r\n\t\t\t//Make this subcategory visible\r\n\t\t\tel.classList.remove('hidden');\r\n\t\t\t\r\n\t\t\t//Show the label\r\n\t\t\tparentDiv.querySelector('#subcategorylabel').classList.remove('hidden');\r\n\t\t});\r\n\t\t\r\n\t//If we just deselected a parent category\r\n\t}else if(parentId == undefined){\r\n\t\t//Hide the label if there is no category visible anymore\r\n\t\tif(parentDiv.querySelector('.childtypes input[type=\"checkbox\"]:checked') == null){\r\n\t\t\tparentDiv.querySelector('#subcategorylabel').classList.add('hidden');\r\n\t\t\r\n\t\t\t//An recipetype is just deselected, find all element with its value as parent attribute\r\n\t\t\tparentDiv.querySelectorAll(\"[data-parent='\"+target.value+\"']\").forEach(el=>{\r\n\t\t\t\t//Make this subcategory invisible\r\n\t\t\t\tel.classList.add('hidden');\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n}\r\n\r\nasync function addCatType(target){\r\n\tlet parentDiv, parentData;\r\n\tlet response\t= await FormSubmit.submitForm(target, 'frontend_posting/add_category');\r\n\r\n\tif(response){\r\n\t\t//Get the newly added category parent id\r\n\t\tlet parentCat  \t= target.closest('form').querySelector('[name=\"cat_parent\"]').value;\r\n\t\tlet postType\t= target.closest('form').querySelector('[name=\"post_type\"]').value;\r\n\t\tlet catName\t\t= target.closest('form').querySelector('[name=\"cat_name\"]').value;\r\n\t\t\r\n\t\t\r\n\t\t//Add the new category as checkbox\r\n\t\tlet html = `\r\n\t\t<div class=\"infobox\" ${parentData}>\r\n\t\t\t<input type=\"checkbox\" class=\"${postType}type\" id=\"${postType}type[]\" value=\"${response.id}\" checked>\r\n\t\t\t<label class=\"option-label category-select\">${catName}</label>\r\n\t\t</div>\r\n\t\t`\r\n\t\tparentDiv.insertAdjacentHTML('afterBegin', html);\r\n\t\tMain.hideModals();\r\n\r\n\t\tMain.displayMessage(`Succesfully added the ${catName} category`);\r\n\t}\r\n}\r\n\r\nasync function addBook(target){\r\n\tlet cell\t\t\t= target.closest('td');\r\n\tlet row\t\t\t\t= target.closest('tr');\r\n\tlet formData\t\t= new FormData();\r\n\r\n\trow.querySelectorAll('input, textarea').forEach(input=>formData.append(input.name, input.value));\r\n\trow.querySelectorAll('td > img').forEach(img=>formData.append('image', img.src));\r\n\tconsole.log(target);\r\n\r\n\ttarget.classList.add('hidden');\r\n\tcell.querySelector(`.loadergif_wrapper`).classList.remove('hidden');\r\n\r\n\tlet response\t= await FormSubmit.fetchRestApi('library/add_book', formData);\r\n\t\r\n\tif(response){\r\n\t\tconsole.log(response);\r\n\r\n\t\tcell.innerHTML\t= response;\r\n\r\n\t\tMain.displayMessage(response.message);\r\n\t}else{\r\n\t\ttarget.classList.remove('hidden');\r\n\t\tcell.querySelector(`.loadergif_wrapper`).classList.add('hidden');\r\n\t}\r\n}\r\n\r\ndocument.addEventListener(\"DOMContentLoaded\", function() {\r\n\t\r\n\r\n});\r\n\r\ndocument.addEventListener(\"click\", event =>{\r\n\tlet target = event.target;\r\n\r\n\tif(target.matches(`.add-book`)){\r\n\t\taddBook(target);\r\n\t}else if(target.matches(`.delete-book`)){\r\n\t\ttarget.remove();\r\n\t}\r\n\t\r\n\t// SHow add category modal\r\n\tif(target.classList.contains('add_cat')){\r\n\t\tdocument.getElementById('add_'+target.dataset.type+'_type').classList.remove('hidden');\r\n\t}\r\n\r\n\tif(target.matches('.add_category .form_submit')){\r\n\t\taddCatType(target);\r\n\t}\r\n});"],"names":["console","log","document","addEventListener","event","target","matches","async","cell","closest","row","formData","FormData","querySelectorAll","forEach","input","append","name","value","img","src","classList","add","querySelector","remove","response","FormSubmit","fetchRestApi","innerHTML","Main","displayMessage","message","addBook","contains","getElementById","dataset","type","submitForm","postType","catName","html","id","parentDiv","insertAdjacentHTML","hideModals","addCatType"],"sourceRoot":""}